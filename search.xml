<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Hello World</title>
      <link href="/2025/06/06/hello-world/"/>
      <url>/2025/06/06/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      <categories>
          
          <category> 博客 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WGS基础流程</title>
      <link href="/2025/05/18/WGS%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B/"/>
      <url>/2025/05/18/WGS%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>本文内容：</p><ul><li>WGS基础流程</li><li>WGS文件流</li><li>WGS文件格式</li></ul><h1 id="WGS基础流程"><a href="#WGS基础流程" class="headerlink" title="WGS基础流程"></a>WGS基础流程</h1><p>大体上分为三步：</p><ul><li>原始数据质控</li><li>数据预处理</li><li>变异检测</li></ul><p>具体一些的流程参考下面的流程图</p><p><img src="https://raw.githubusercontent.com/chide-org/PicGo/main/img/wgs%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B.jpg" alt="wgs数据分析流程"></p><h1 id="WGS文件流"><a href="#WGS文件流" class="headerlink" title="WGS文件流"></a>WGS文件流</h1><p>我自己整理了一个思维导图：</p><ul><li>荧光黄加双方框：步骤名称</li><li>淡红色方块：输入文件</li><li>荧光黄方块：输出文件</li><li>黑色方框：软件</li><li>灰色方框：软件的模块</li></ul><p><img src="https://raw.githubusercontent.com/chide-org/PicGo/main/img/WGS%E6%96%87%E4%BB%B6%E6%B5%81%EF%BC%88%E8%BD%BB%E9%87%8F%EF%BC%89.jpg" alt="WGS文件流（轻量）"></p><h1 id="WGS文件格式"><a href="#WGS文件格式" class="headerlink" title="WGS文件格式"></a>WGS文件格式</h1><p>本节介绍的文件格式：</p><ul><li>fastq</li><li>fasta</li><li>bam &amp; sam &amp; cram &amp; bai</li><li>vcf</li></ul><h2 id="fastq"><a href="#fastq" class="headerlink" title="fastq"></a>fastq</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@DJB775P1:248:D0MDGACXX:7:1202:12362:49613</span><br><span class="line">TGCTTACTCTGCGTTGATACCACTGCTTAGATCGGAAGAGCACACGTCTGAA</span><br><span class="line">+</span><br><span class="line">JJJJJIIJJJJJJHIHHHGHFFFFFFCEEEEEDBD?DDDDDDBDDDABDDCA</span><br><span class="line">@DJB775P1:248:D0MDGACXX:7:1202:12782:49716</span><br><span class="line">CTCTGCGTTGATACCACTGCTTACTCTGCGTTGATACCACTGCTTAGATCGG</span><br><span class="line">+</span><br><span class="line">IIIIIIIIIIIIIIIHHHHHHFFFFFFEECCCCBCECCCCCCCCCCCCCCCC</span><br></pre></td></tr></table></figure><p>类型：文本文件</p><p>内容：产生自测序仪的原始测序数据</p><p>标识：.fastq  .fq  .fq.gz</p><p>组成：每四行成为一个独立的单元，我们称之为read。</p><ul><li>第一行：以‘@’开头，是这一条read的名字，这个字符串是根据测序时的状态信息转换过来的，中间不会有空格，它是每一条read的唯一标识符，同一份FASTQ文件中不会重复出现，甚至不同的FASTQ文件里也不会有重复；</li><li>第二行：测序read的序列，由A，C，G，T和N这五种字母构成，这也是我们真正关心的DNA序列，N代表的是测序时那些无法被识别出来的碱基；</li><li>第三行：以‘+’开头，在旧版的FASTQ文件中会直接重复第一行的信息，但现在一般什么也不加（节省存储空间）；</li><li>第四行：测序read的质量值，这个和第二行的碱基信息一样重要，它描述的是每个测序碱基的可靠程度，用ASCII码表示。<blockquote><p>质量值：碱基测量错误率越低，质量值就越高。测序错误率为p_error，质量值为Q：Q &#x3D; -10lg(p_error)<br>ASCII码与质量值Q的对应关系标准如下所示，我们把加33的的质量值体系称之为Phred33，现在一般都是使用Phred33这个体系</p></blockquote></li></ul><table><thead><tr><th>测序平台</th><th>ASCII码范围</th><th>下限</th><th>质量值类型</th><th>质量值范围</th><th>备注</th></tr></thead><tbody><tr><td>Sanger, Illumina(版本1.8及以上)</td><td>33-126</td><td>33</td><td>Phred quality score</td><td>0-93</td><td>现在沿用</td></tr><tr><td>Solexa, Illumina早期版本(&lt;1.3)</td><td>59-126</td><td>64</td><td>Solexa quality score</td><td>5-62</td><td>除了已测序数据之外，不再使用</td></tr><tr><td>Illumina(版本1.3-1.7)</td><td>64-126</td><td>64</td><td>Phred quality score</td><td>0-62</td><td>除了已测序数据之外，不再使用</td></tr></tbody></table><h2 id="fasta"><a href="#fasta" class="headerlink" title="fasta"></a>fasta</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;gene_00284728 length=231;type=dna</span><br><span class="line">GAGAACTGATTCTGTTACCGCAGGGCATTCGGATGTGCTAAGGTAGTAATCCATTATAAGTAACATG</span><br><span class="line">CGCGGAATATCCGGGAGGTCATAGTCGTAATGCATAATTATTCCCTCCCTCAGAAGGACTCCCTTGC</span><br><span class="line">GAGACGCCAATACCAAAGACTTTCGTAAGCTGGAACGATTGGACGGCCCAACCGGGGGGAGTCGGCT</span><br><span class="line">ATACGTCTGATTGCTACGCCTGGACTTCTCTT</span><br></pre></td></tr></table></figure><p>类型：文本文件</p><p>内容：存储着<strong>有顺序</strong>的序列数据<br>（如参考基因组序列、蛋白质序列、编码DNA序列、转录本序列）</p><p>标识：.fasta  .fa  .fa.gz</p><p>组成：</p><ul><li><strong>头信息</strong>：一个空格把头信息分为两个部分。第一部分是序列名字，它和大于号（&gt;）紧接在一起；第二部分是注释信息，这个可以没有，就看具体需要。</li><li><strong>序列</strong>：具体的序列数据</li></ul><h2 id="bam-sam-cram-bai"><a href="#bam-sam-cram-bai" class="headerlink" title="bam &amp; sam &amp; cram &amp; bai"></a>bam &amp; sam &amp; cram &amp; bai</h2><p>sam是一个存储着序列比对数据的文本文件；bam是其二进制压缩格式，也是目前通用的对比数据存储格式；cram是bam的高压缩格式；bai是bam文件的索引文件</p><p><img src="https://raw.githubusercontent.com/chide-org/PicGo/main/img/bam%20file.jpg" alt="bam file"></p><p>组成：SAM文件分为两个部分：header和record。这里额外说一句，许多NGS组学数据的存储格式都是由header和record两部分组成的。</p><ul><li>header内容不多，也不会太复杂，每一行都用‘@’ 符号开头，里面主要包含了版本信息，序列比对的参考序列信息，如果是标准工具（bwa，bowtie，picard）生成的BAM，<strong>一般还会包含生成该份文件的参数信息（如上图），</strong>@<strong>PG标签开头的那些</strong>。</li><li>这里需要重点提一下的是header中的@RG也就是Read group信息，这是在做后续数据分析时专门用于区分不同样本的重要信息。<strong>它的重要性还体现在，如果原来样本的测序深度比较深，一般会按照不同的lane分开比对，最后再合并在一起，那么这个时候你会在这个BAM文件中看到有多个RG，里面记录了不同的lane，甚至测序文库的信息，唯一不变的一定是SM的sample信息，这样合并后才能正确处理</strong>。</li><li>record：这是我们通常所说的序列比对内容，每一行都是一条read比对信息，recoed中的每一个信息都是用制表符tab分开的，如下图所示：</li></ul><p><img src="https://raw.githubusercontent.com/chide-org/PicGo/main/img/bam%20record.jpg" alt="bam record"></p><table><thead><tr><th>对应上图</th><th>列序号</th><th>名称</th><th>内容描述</th></tr></thead><tbody><tr><td>read name</td><td>1</td><td>QNAME</td><td>fq的read ID (QNAME中的Q表示Query)</td></tr><tr><td>flags</td><td>2</td><td>FLAG</td><td>比对信息位 (bitwise FLAG)，是一个由16位整数</td></tr><tr><td>position</td><td>3</td><td>RNAME</td><td>参考序列染色体名称 (RNAME中的R表示Reference)</td></tr><tr><td>position</td><td>4</td><td>POS</td><td>比对位置,从对应染色体的第1位开始往后计算</td></tr><tr><td>MAPQ</td><td>5</td><td>MAPQ</td><td>比对质量值 (Mapping Quality)</td></tr><tr><td>CIGAR</td><td>6</td><td>CIGAR</td><td>比对信息</td></tr><tr><td>Mate information</td><td>7</td><td>RNEXT</td><td>配对read所比对到的染色体 (仅Pair end 测序的数据才有)</td></tr><tr><td>Mate information</td><td>8</td><td>PNEXT</td><td>配对read所比对到的位置 (仅Pair end 测序的数据才有)</td></tr><tr><td>Mate information</td><td>9</td><td>TLEN</td><td>插入片段长度 (仅Pair end 测序的数据才有)</td></tr><tr><td>Read sequence</td><td>10</td><td>SEQ</td><td>read序列</td></tr><tr><td>Quality scores</td><td>11</td><td>QUAL</td><td>read质量值</td></tr><tr><td>metadata</td><td>12</td><td>Metadata</td><td>元信息,从第12列开始往后都是metadata,一般会包括RG信息, missmatch信息等</td></tr><tr><td>…</td><td>…</td><td>…</td><td>…</td></tr></tbody></table><h2 id="vcf"><a href="#vcf" class="headerlink" title="vcf"></a>vcf</h2><p>vcf （Variant Call Format）是一种用于存储基因组序列中的变异信息</p><ul><li>一般用在 单核苷酸变异（SNV），小片段插入缺失（INDEL）等</li><li>也用于 拷贝数变异（CNV），SV（结构变异）等</li><li>SNV：参考基因组在1号染色体7845190为 C，但检测样本在同样位置为 A</li><li>INDEL：包含插入和缺失两种<ul><li>Insertion：参考基因组某片段为 ACTTG，但是检测样本同样位置为 ACCCTTG，插入了CC</li><li>Deletion：参考基因组某片段为 TTCGG，但是检测样本同样位置为 TTGG，缺失 C</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#CHROM  POS ID  REF ALT QUAL    FILTER  INFO</span><br><span class="line">1   10177   rs367896724 A   AC  100 PASS    AC=2130;AF=0.425319;AN=5008;NS=2504;DP=103152;EAS_AF=0.3363;AMR_AF=0.3602;AFR_AF=0.4909;EUR_AF=0.4056;SAS_AF=0.4949;AA=|||unknown(NO_COVERAGE);VT=INDEL</span><br><span class="line">1   10235   rs540431307 T   TA  100 PASS    AC=6;AF=0.00119808;AN=5008;NS=2504;DP=78015;EAS_AF=0;AMR_AF=0.0014;AFR_AF=0;EUR_AF=0;SAS_AF=0.0051;AA=|||unknown(NO_COVERAGE);VT=INDEL</span><br><span class="line">1   10352   rs555500075 T   TA  100 PASS    AC=2191;AF=0.4375;AN=5008;NS=2504;DP=88915;EAS_AF=0.4306;AMR_AF=0.4107;AFR_AF=0.4788;EUR_AF=0.4264;SAS_AF=0.4192;AA=|||unknown(NO_COVERAGE);VT=INDEL</span><br><span class="line">1   10505   rs548419688 A   T   100 PASS    AC=1;AF=0.000199681;AN=5008;NS=2504;DP=9632;EAS_AF=0;AMR_AF=0;AFR_AF=0.0008;EUR_AF=0;SAS_AF=0;AA=.|||;VT=SNP</span><br><span class="line">1   10506   rs568405545 C   G   100 PASS    AC=1;AF=0.000199681;AN=5008;NS=2504;DP=9676;EAS_AF=0;AMR_AF=0;AFR_AF=0.0008;EUR_AF=0;SAS_AF=0;AA=.|||;VT=SNP</span><br><span class="line">1   10511   rs534229142 G   A   100 PASS    AC=1;AF=0.000199681;AN=5008;NS=2504;DP=9869;EAS_AF=0;AMR_AF=0.0014;AFR_AF=0;EUR_AF=0;SAS_AF=0;AA=.|||;VT=SNP</span><br><span class="line">1   10539   rs537182016 C   A   100 PASS    AC=3;AF=0.000599042;AN=5008;NS=2504;DP=9203;EAS_AF=0;AMR_AF=0.0014;AFR_AF=0;EUR_AF=0.001;SAS_AF=0.001;AA=.|||;VT=SNP</span><br><span class="line">1   10542   rs572818783 C   T   100 PASS    AC=1;AF=0.000199681;AN=5008;NS=2504;DP=9007;EAS_AF=0.001;AMR_AF=0;AFR_AF=0;EUR_AF=0;SAS_AF=0;AA=.|||;VT=SNP</span><br><span class="line">1   10579   rs538322974 C   A   100 PASS    AC=1;AF=0.000199681;AN=5008;NS=2504;DP=5502;EAS_AF=0;AMR_AF=0;AFR_AF=0.0008;EUR_AF=0;SAS_AF=0;AA=.|||;VT=SNP</span><br><span class="line">1   10616   rs376342519 CCGCCGTTGCAAAGGCGCGCCG  C   100 PASS    AC=4973;AF=0.993011;AN=5008;NS=2504;DP=2365;EAS_AF=0.9911;AMR_AF=0.9957;AFR_AF=0.9894;EUR_AF=0.994;SAS_AF=0.9969;VT=INDEL</span><br><span class="line">1   10642   rs558604819 G   A   100 PASS    AC=21;AF=0.00419329;AN=5008;NS=2504;DP=1360;EAS_AF=0.003;AMR_AF=0.0014;AFR_AF=0.0129;EUR_AF=0;SAS_AF=0;AA=.|||;VT=SNP</span><br><span class="line">1   11008   rs575272151 C   G   100 PASS    AC=441;AF=0.0880591;AN=5008;NS=2504;DP=2232;EAS_AF=0.0367;AMR_AF=0.0965;AFR_AF=0.1346;EUR_AF=0.0885;SAS_AF=0.0716;AA=.|||;VT=SNP</span><br><span class="line">1   11012   rs544419019 C   G   100 PASS    AC=441;AF=0.0880591;AN=5008;NS=2504;DP=2090;EAS_AF=0.0367;AMR_AF=0.0965;AFR_AF=0.1346;EUR_AF=0.0885;SAS_AF=0.0716;AA=.|||;VT=SNP</span><br></pre></td></tr></table></figure><p>组成：文件一般包含两部分，</p><ul><li>注释信息（header）：位于文件开始，每行以 #开始</li><li>变异信息（body）：没有 #即为记录的变异信息</li></ul><table><thead><tr><th>字段</th><th>描述</th><th align="center">举例</th></tr></thead><tbody><tr><td>CHROM</td><td>染色体号，注意不需要前缀 chr</td><td align="center">1</td></tr><tr><td>POS</td><td>变异位点，对于 INDEL，为 INDEL 的第一个碱基位点</td><td align="center">10616</td></tr><tr><td>ID</td><td>dbSNP 的编号，.为置空</td><td align="center">rs376342519</td></tr><tr><td>REF</td><td>参考基因组的碱基，也就是等位基因</td><td align="center">CCGCCGTTGCAAAGGCGCGCCG</td></tr><tr><td>ALT</td><td>检测样本的碱基，同一位置有多个则以,分隔</td><td align="center">C</td></tr><tr><td>QUAL</td><td>Phred 的质量值，表示改位点存在变异的可能性。分数越高则认为越可靠，但同时需要考虑测序深度，覆盖度等因素。.代表置空，不代表质量值为 0。</td><td align="center">100</td></tr><tr><td>FILTER</td><td>过滤标志，如果为 PASS则认为是一个变异</td><td align="center">PASS</td></tr><tr><td>INFO</td><td>详细信息，用 key&#x3D;value的格式来表示。key 一般是简写，具体描述在文件开头的 header lines 中显示。</td><td align="center">AC&#x3D;4973;AF&#x3D;0.993011;AN&#x3D;5008;VT&#x3D;INDEL</td></tr><tr><td>FORMAT</td><td>可选，变异位点格式，包括 GT，AD，DP，GQ，PL&#x2F; GT，AD，DP，GQ，PGT，PID，PL，PS</td><td align="center">GT:DP:GQ:PL</td></tr><tr><td>SAMPLEs</td><td>可选，各个样本的值，来自 BAM 文件 @RG 的 SM 标签。一般每个样本对应一列，因此该文件会超过十列。每个样本会与 FORMAT 列的格式一一对应，不同格式用 :分隔</td><td align="center">0&#x2F;1:50:99:0,20,200</td></tr></tbody></table><hr><blockquote><p>这部分暂时咕咕</p></blockquote><h1 id="WGS软件"><a href="#WGS软件" class="headerlink" title="WGS软件"></a>WGS软件</h1><p>本节介绍的软件：</p><ul><li>FastQC</li><li>Trimmomatic</li><li>BWA</li><li>Samtools</li><li>Picard</li><li>GATK</li></ul><h2 id="FastQC"><a href="#FastQC" class="headerlink" title="FastQC"></a>FastQC</h2><h2 id="Trimmomatic"><a href="#Trimmomatic" class="headerlink" title="Trimmomatic"></a>Trimmomatic</h2><h2 id="BWA"><a href="#BWA" class="headerlink" title="BWA"></a>BWA</h2><h2 id="Samtools"><a href="#Samtools" class="headerlink" title="Samtools"></a>Samtools</h2><h2 id="Picard"><a href="#Picard" class="headerlink" title="Picard"></a>Picard</h2><h2 id="GATK"><a href="#GATK" class="headerlink" title="GATK"></a>GATK</h2>]]></content>
      
      
      <categories>
          
          <category> 生信 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WGS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>孟德尔随机化笔记</title>
      <link href="/2024/01/31/%E5%AD%9F%E5%BE%B7%E5%B0%94%E9%9A%8F%E6%9C%BA%E5%8C%96%E7%AC%94%E8%AE%B0/"/>
      <url>/2024/01/31/%E5%AD%9F%E5%BE%B7%E5%B0%94%E9%9A%8F%E6%9C%BA%E5%8C%96%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<blockquote><p>这是一份双样本孟德尔随机化（MR）的代码实操笔记，在这里你可以了解如何用R，在自己的电脑上判断一下两个表型之间是否具有潜在的因果关系。因为是刚刚接触MR，难免有不准确之处，本文仅作参考。</p></blockquote><h2 id="1，获取数据"><a href="#1，获取数据" class="headerlink" title="1，获取数据"></a>1，获取数据</h2><ul><li><p>现存 GWAS 数据样本大多为欧洲样本，少量其他样本</p></li><li><p>关键要点：暴露与结局数据不存在或存在少量可接受范围内的样本重叠</p></li><li><p>必须数据(<code>snp</code> || <code>p</code> || <code>effect_allele</code> || <code>other_allele</code> || <code>or(beta)</code> || <code>se</code>)</p><ul><li><p>SNP_ID (rs123456)：唯一识别号</p></li><li><p>p_value：snp 位点与表型的相关程度( 0 &lt; p &lt; 1)</p></li><li><p>effect_allele：变异位点</p></li><li><p>other_allele：常规位点</p></li><li><p>Beta：连续型变量的相对风险比，(R，大于 0 促进发生，小于 0 抑制表型)</p><ul><li><p>OR：二分类变量的相对风险比，(OR &gt; 0，大于 1 促进发生，小于 1 抑制表型)</p></li><li><p>Beta &#x3D; ln(OR)</p></li></ul></li><li><p>Standard error(se)：标准差，代表相对风险比 Beta 的准确性</p></li><li><p>(非必须)Effect allele frequency(eaf)：效应位点频率，算工具变量的时候需要，计算 R^2 时需要 MAF</p></li></ul></li></ul><h2 id="2，读取数据"><a href="#2，读取数据" class="headerlink" title="2，读取数据"></a>2，读取数据</h2><ul><li><p>首先设置工作环境，R-&gt; NewProject-&gt; working Env，文件名可以有路径</p></li><li><p>更快的数据读取方法：<code>data.table</code>包下的<code>fread()</code>函数可替代 read.table()</p></li><li><p>“snp_gwas.tbl.txt” -&gt; 直接用 <code>read.table()</code>读取，可加 <code>header = T</code></p><ul><li>.txt :文本文件，可以用记事本打开的</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data &lt;- read.table(&quot;snp_gwas.tbl.txt&quot;,header = T)</span><br><span class="line">View(data)</span><br></pre></td></tr></table></figure></li><li><p>“snp_gwas.txt.gz” -&gt; 直接用<code>read.table()</code>读取，可加<code>header = T</code></p><ul><li>.gz : gzip 压缩后的文件，解压之后再读取似乎会快一点，当然也可以直接读取</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data &lt;- read.table(&quot;snp_gwas.txt.gz&quot;,header = T)</span><br><span class="line">View(data)</span><br></pre></td></tr></table></figure></li><li><p>“snp_gwas.xlsx” -&gt; 可以使用<code>readxl</code>包下的<code>read_excel()</code>函数读取</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">library(readxl)</span><br><span class="line">data &lt;- read_excel(&quot;snp_gwas.xlsx&quot;)</span><br></pre></td></tr></table></figure></li><li><p>“ieu-b-4979.vcf.gz” -&gt; 利用<code>VariantAnnotation</code>和<code>gwasvcf</code>包将 vcf 格式文件转换成 tibble 格式文件，函数分别对应<code>readVcf()</code>和<code>vcf_to_tibble()</code>，后者 id 应该可以不加</p><ul><li><p>VCF: Variant Call Format，变异调用格式，是一种常用于存储基因组变异信息的文本文件格式。它是生物信息学领域中一种标准格式，用于描述个体基因组的单核苷酸变异（SNP，Single Nucleotide Polymorphism）、插入或删除等变异信息</p></li><li><p>VCF 文件中的列描述行（Column Header Line）包含对列名的解释，这有助于理解每个列中存储的信息，列描述行位于以 #CHROM 开始的行之前，以 ##FORMAT 开始</p></li><li><p>可在 bash 命令行中使用<code>head -n 20 your_vcf_file.vcf</code>查看前 20 行数据</p></li><li><p>可在 R 中使用<code>readLines(&quot;./ieu-a-2.vcf&quot;,n=20)</code>读取前 20 行数据</p></li><li><p>可在 powershell 命令行中使用<code>Get-Content -TotalCount 20 your_vcf_file.vcf</code>查看前 20 行数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data0=VariantAnnotation::readVcf(&quot;ieu-b-4979.vcf.gz&quot;)</span><br><span class="line">data1=gwasvcf::vcf_to_tibble(data0,id=&#x27;ieu-b-4979&#x27;) # 这样就能得到tibble格式的数据了，但是没有列名解释; id参数大概可以不要</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vcf20 &lt;- readLines(&quot;./MR数据/bmi-2/ieu-a-2.vcf&quot;,n=20)</span><br><span class="line">print(vcf20)# 可以看到前20行数据</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PS D:\A-MR\MR数据\bmi-2&gt; Get-Content -TotalCount 20 ieu-a-2.vcf</span><br><span class="line">##fileformat=VCFv4.2</span><br><span class="line">##FILTER=&lt;ID=PASS,Description=&quot;All filters passed&quot;&gt;</span><br><span class="line">##INFO=&lt;ID=AF,Number=A,Type=Float,Description=&quot;Allele Frequency&quot;&gt;</span><br><span class="line">##FORMAT=&lt;ID=ES,Number=A,Type=Float,Description=&quot;Effect size estimate relative to the alternative allele&quot;&gt;</span><br><span class="line">##FORMAT=&lt;ID=SE,Number=A,Type=Float,Description=&quot;Standard error of effect size estimate&quot;&gt;</span><br><span class="line">(数据的格式)</span><br></pre></td></tr></table></figure></li></ul></li></ul><h2 id="3，将数据写入文件"><a href="#3，将数据写入文件" class="headerlink" title="3，将数据写入文件"></a>3，将数据写入文件</h2><ul><li><p>csv：一种以逗号为分隔符的文件格式，支持 excel 打开，适合存储表格数据</p></li><li><p>使用函数<code>write.csv()</code>，前一个变量是变量名，后一个 file &#x3D; “文件名”</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">write.csv(data,file = &quot;exposure.csv&quot;)</span><br></pre></td></tr></table></figure></li></ul><h2 id="4，Exposure-Data-处理，获得工具变量"><a href="#4，Exposure-Data-处理，获得工具变量" class="headerlink" title="4，Exposure Data 处理，获得工具变量"></a>4，Exposure Data 处理，获得工具变量</h2><ul><li><p>相关性设置</p><ul><li><p>筛选条件：p &lt; 5e-08 ( 视条件而定 )</p></li><li><p>使用 base 包的 <code>subset( )</code> 即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data_subseted &lt;- subset(data,p &lt; 5e-08)</span><br><span class="line">View(data_subseted)</span><br><span class="line">write.csv(data_subseted,file = &quot;data_subseted.csv&quot;)</span><br></pre></td></tr></table></figure></li></ul></li><li><p>独立性设置</p><ul><li><p>首先将 subseted 的文件放在 TwoSampleMR 文件夹下</p></li><li><p>筛选条件：LD 连锁不平衡，r^2 &lt; 0.001(最大 0.1) , kb &#x3D; 10000</p></li><li><p>读取文件路径，使用<code>system.file()</code>函数，前一个参数是包下的相对路径，后一个参数是包名，主要作用是根据指定的包和文件路径获取完整的文件路径</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">road &lt;- system.file(&quot;package_folder/exposure.csv&quot;,package = &quot;TwoSampleMR&quot;)</span><br></pre></td></tr></table></figure></li><li><p>规范读取数据：利用 TwoSampleMR 包的 <code>read_exposure_data()</code> 规范读取数据，参数分为四个部分：文件路径、分隔符、规范列名、最后一个是当有多个暴露时，将多个暴露合在一起跑，可以通过 phenotype_col 识别每一个暴露的标识，从而单独跑每一个暴露</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">exposure_data &lt;- read_exposure_data(</span><br><span class="line"></span><br><span class="line">    filename = road,</span><br><span class="line"></span><br><span class="line">    sep = &quot;,&quot;,</span><br><span class="line"></span><br><span class="line">    snp_col = &quot;SNP_col_name&quot;,</span><br><span class="line">    pval_col = &quot;p_col_name&quot;,</span><br><span class="line">    effect_allele_col = &quot;effct_allele_col_name&quot;,</span><br><span class="line">    other_allele_col = &quot;other_allele_col_name&quot;,</span><br><span class="line">    beta_col = &quot;beta_col_name&quot;,</span><br><span class="line">    se_col = &quot;se_col_name&quot;,</span><br><span class="line">    eaf_col = &quot;eaf_col_name&quot;,</span><br><span class="line"></span><br><span class="line">    clump = F , ## 若为T则在读取的同时进行clump操作</span><br><span class="line"></span><br><span class="line">    phenotype_col = &quot;exposure_type_col_name&quot;</span><br><span class="line">    )</span><br></pre></td></tr></table></figure></li><li><p>独立性设置(clump): 去除连锁不平衡的 snp，利用 TwoSampleMR 包的 <code>clump_data()</code>，必须参数是上一步读取的数据 exposure_data，可设置参数是 clump_kb &#x3D; 10000,clump_r2 &#x3D; 0.001</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exposure_data_clumped &lt;- clump_data(exposure_data)</span><br></pre></td></tr></table></figure></li></ul></li><li><p>统计强度设置</p><ul><li><p>F 值可放到后面计算，影响不大</p></li><li><p>F &#x3D; R^2(N-2)&#x2F;(1- R^2) (F &gt; 10 的 snp 才强相关，小于 10 的可以手动剔除)</p></li></ul></li></ul><h2 id="5，Outcome-Data-处理，提取结局中的-snp"><a href="#5，Outcome-Data-处理，提取结局中的-snp" class="headerlink" title="5，Outcome Data 处理，提取结局中的 snp"></a>5，Outcome Data 处理，提取结局中的 snp</h2><ul><li><p>导入结局数据</p><ul><li><p>可能出现暴露和结局的效应等位基因不一致的情况，正常现象</p></li><li><p>可能出现暴露的部分 snp 在结局中没有，数量小可以容忍，数量大建议放弃</p></li><li><p>丢失的 snp 可以通过找代理 snp 解决，但较麻烦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data &lt;- read.table(&quot;outcome.txt&quot;,header = T)</span><br><span class="line">## 如是其他文件格式，参见  “2，读取数据”</span><br></pre></td></tr></table></figure></li></ul></li><li><p>merge，提取交集，得到 outcome 数据，第一个参数是 clump 过的暴露数据名，第二个参数是刚读取的结局数据名，后面 by.x 和 by.y 分别是暴露和结局的 snp 的 rs 编号的列名，得到的数据前一部分是暴露的，后一部分是结局的，all.x 表示把暴露的 snp 的全部都找出来，在 outcome 中没有的以 NA 填充</p><ul><li>当 merge 后有丢失的 snp，可以在代理 snp 网站上去找（也可以不找），一个 snp 会给你一个及以上的代理 snp，拿这些 snp 与 outcome 再做一次 merge，找出可用的 snp，对于同一个丢失 snp 的对应 snp，应当选择 R^2 最大的代理 snp 作为代理 -&gt; 找到之后不用换 snp 的 rs 号，直接将数据填充 NA 即可</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">outcome &lt;- merge(</span><br><span class="line">    exposure_data_clumped,</span><br><span class="line">    data,</span><br><span class="line">    by.x = &quot;exposure_snp_col_name&quot;,</span><br><span class="line">    by.y = &quot;data_snp_col_name&quot;,</span><br><span class="line">    all.x = T</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">write.csv(outcome,file = &quot;outcome.csv&quot;  )</span><br></pre></td></tr></table></figure></li><li><p>规范读取 outcome 数据，使用 TwoSampleMR 的 <code>read_outcome_data()</code>函数，第一个参数是暴露挑选出的工具变量，第二个参数是结局文件路径，第三个参数是间隔符，第四部分是列名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">outcome_data &lt;- read_outcome_data(</span><br><span class="line"></span><br><span class="line">    snps =exposure_data$SNP,</span><br><span class="line"></span><br><span class="line">    filename = &quot;outcome.csv&quot;,</span><br><span class="line"></span><br><span class="line">    sep = &quot;,&quot;,</span><br><span class="line"></span><br><span class="line">    snp_col = &quot;SNP_col_name&quot;,</span><br><span class="line">    pval_col = &quot;p_col_name&quot;,</span><br><span class="line">    effect_allele_col = &quot;effct_allele_col_name&quot;,</span><br><span class="line">    other_allele_col = &quot;other_allele_col_name&quot;,</span><br><span class="line">    beta_col = &quot;beta_col_name&quot;,</span><br><span class="line">    se_col = &quot;se_col_name&quot;,</span><br><span class="line">    eaf_col = &quot;eaf_col_name&quot;,</span><br><span class="line"></span><br><span class="line">)</span><br></pre></td></tr></table></figure></li><li><p>常见问题</p><ul><li><p>样本重叠，用 meta 分析的暴露和结局下的队列样本数分别除以暴露和结局的 snp 数，得到的比重取最大值（具体待细查），蔡老师认为在 10%以下都可以接受</p></li><li><p>结局的 snp 数量要足够多，merge 才能丢失最少的 snp,即结局的中的 snp 多到涵盖大部分工具变量 snp</p></li></ul></li></ul><h2 id="6，Harmonize-Data-协同数据"><a href="#6，Harmonize-Data-协同数据" class="headerlink" title="6，Harmonize Data 协同数据"></a>6，Harmonize Data 协同数据</h2><ul><li><p>Harmonize 协同作用</p><ul><li><p>将 exposure_snp 和 outcome_snp 等位基因方向协同</p></li><li><p>根据 eaf 大小，剔除不能判断方向的 palindromic snp</p></li><li><p>剔除 incompatible snp (A&#x2F;G vs. A&#x2F;C)</p></li></ul></li><li><p>使用 <code>harmonise_data()</code>即可，结果中会把 palindromic snp 和 incompatible snp 列出来并在 mr_keep 列标记为”FALSE”，意为在后面的 mr 分析中没有把这些 snp 纳入分析</p></li><li><p>注意要保存协同后的数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dat_harmon &lt;- harmonise_data(</span><br><span class="line">  exposure_dat = exposure_dat_name,</span><br><span class="line">  outcome_dat = outcome_dat_name</span><br><span class="line">  )</span><br><span class="line">View(dat_harmon)</span><br><span class="line">write.csv(dat_harmon,file = &quot;dat_harmon.csv&quot;)</span><br></pre></td></tr></table></figure></li></ul><h2 id="7，MR-分析，获得因果关系结果"><a href="#7，MR-分析，获得因果关系结果" class="headerlink" title="7，MR 分析，获得因果关系结果"></a>7，MR 分析，获得因果关系结果</h2><ul><li><p>可使用 <code>mr()</code>直接处理协同后的数据，默认使用五种方法分析(下为方法在函数中的命名)</p><ul><li>mr_egger_regression</li><li>mr_weighted_median</li><li>mr_ivw</li><li>mr_simple_mode</li><li>mr_weighted_mode</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dat_harmon_mr &lt;- mr(dat_harmon)</span><br></pre></td></tr></table></figure></li><li><p>也可使用<code>mr_method_list()</code>看函数有哪些方法，并指定使用哪些方法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dat_harmon_mr &lt;- mr(</span><br><span class="line">  dat_harmon,</span><br><span class="line">  method_list = c(</span><br><span class="line">    &quot;mr_ivw&quot;,</span><br><span class="line">    &quot;mr_egger_regression&quot;,</span><br><span class="line">    &quot;mr_weighted_median&quot;</span><br><span class="line">    )</span><br><span class="line">  )</span><br></pre></td></tr></table></figure></li><li><p>如何看待 mr 的结果</p><ul><li>首先看 ivw 的 p 值，若小于 0.05 说明有因果关系</li><li>其次看其他方法的 beta 值，若都大于 0 或小于 0，即方向一致，则没有问题</li><li>若非如此，需要具体问题具体分析，有时（当 ivw 的结果不可靠时）会以 weight_median 的 p 值为准</li><li>没有问题就可以进入下一步分析异质性</li></ul></li><li><p>mr 分析可视化：使用<code>mr_scatter_plot()</code>，第一个参数是 mr 指定三种方法的分析结果，第二个参数是协同化的数据名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mr_scatter_plot(</span><br><span class="line">  mr_results = mr(</span><br><span class="line">    dat_harmon,</span><br><span class="line">    method_list = c(&quot;mr_ivw&quot;,</span><br><span class="line">                  &quot;mr_weighted_median&quot;,</span><br><span class="line">                  &quot;mr_egger_regression&quot;</span><br><span class="line">                    )</span><br><span class="line">    ),</span><br><span class="line">  dat_harmon</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chide-org/PicGo/main/img/mr_scatter_plot.png" alt="mr_scatter_plot"></p></li></ul><h2 id="8，异质性检测，"><a href="#8，异质性检测，" class="headerlink" title="8，异质性检测，"></a>8，异质性检测，</h2><ul><li><p>异质性检测</p><ul><li><p>异质性：在 Mendelian 随机化（MR）研究中，异质性测试用于检查基因对因果效应的影响是否在不同基因位点之间存在显著差异。这有助于确定基因对因果关系的一致性</p></li><li><p>使用 <code>mr_heterogeneity()</code>即可得到</p></li><li><p>主要看 ivw 的 Q_pval ,叫做 Cochran Q test，小于 0.05 说明有异质性</p></li><li><p>有异质性说明结果不太靠谱，但在 mr 分析中，异质性对结果的可靠性影响不大</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dat_harmon_hetero &lt;- mr_heterogeneity(dat_harmon)</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chide-org/PicGo/main/img/MR_hetero.jpg" alt="MR_hetero"></p></li></ul></li><li><p>MR_PRESSO(若存在异质性)</p><ul><li><p>若要看产生异质性的 snp 是哪些，可以用 MR PRESSO，直接使用 TwoSampleMR 包下的<code>run_mr_presso()</code>函数，第一个参数是协同化的数据，第二个参数相当于迭代次数，snp 越多，数字要设置的越大，跑的深度越深，算出来的离群值越准确，老师推荐 10000</p></li><li><p>结果中会对每一个 snp 计算 p 值，小于 0.05 说明这个 snp 是离群值，Distortion Test $Outliers Indices 会指明是哪个 snp 的 p 小于 0.05</p></li><li><p>结果中有一个 Distortion Test $Pvalue ,大于 0.05 说明离群值没有影响，小于 0.05 说明这个离群值对结果的方向有影响，即对 SNP 的 beta 或 OR 值的一致性有影响</p></li><li><p>挑选出离群值之后，可以剔除离群值，再次进行 MR 分析</p><ul><li>实例####</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run_mr_presso(alzheimer_and_bmi_harmon,NbDistribution = 3000)</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chide-org/PicGo/main/img/MR_PRESSO.jpg" alt="MR_PRESSO"></p></li></ul></li><li><p>异质性可视化</p><ul><li><p>使用<code>mr_funnel_plot()</code>,只有一个参数 singlesnp_results，需要使用<code>mr_singlesnp()</code>函数处理协同化的数据，这样即可得到漏斗图，越对称越好</p></li><li><p>有两条线，ivw 和 mr_egger，在实践中，这两个漏斗图都应该对称，因为对称漏斗图表明 MR 方法的假设没有受到系统性的偏倚或异质性的影响</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mr_funnel_plot(singlesnp_results =</span><br><span class="line">    mr_singlesnp(dat_harmon)</span><br><span class="line">  )</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chide-org/PicGo/main/img/mr_funnel_plot.png" alt="mr_funnel_plot"></p></li></ul></li></ul><h2 id="9，多效性检测"><a href="#9，多效性检测" class="headerlink" title="9，多效性检测"></a>9，多效性检测</h2><ul><li><p>多效性：多效性（Pleiotropy）是遗传学中的一个现象，指的是一个基因或基因变异影响多个表型特征，这些特征看似无关。这与“一个基因，一个特征”的原则相对立。多效性主要分为水平多效性和方向多效性两种类型，水平多效性代表特征之间没有强相关，方向多效性代表特征之间有强的关联</p></li><li><p>使用<code>mr_pleiotropy_test()</code>函数，唯一参数为协同化的数据，当结果的 pval &lt; 0.05 时说明有多效性，大于 0.05 时说明没有多效性，取决于 egger_intercept 即 egger 分析的回归直线的截距，意为暴露效应为 0 时结局的效应值，小于 0 对应 pval &lt; 0.05 ,等于 0 对应 pval &gt; 0.05</p></li><li><p>多效性 p 值应当大于 0.05，没有多效性；若存在多效性，则结果不可靠</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mr_pleiotropy_test(dat_harmon)</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chide-org/PicGo/main/img/pleiotropy.png"></p></li></ul><h2 id="10，leave-one-out-analysis"><a href="#10，leave-one-out-analysis" class="headerlink" title="10，leave one out analysis"></a>10，leave one out analysis</h2><ul><li><p>丢掉一个 snp 之后再次进行 mr 分析，如果是阳性结果，数据点应当都在 y 轴虚线的一侧，有人要求更加严格，需要置信区间也都在 y 轴的一侧</p></li><li><p>如果是阴性结果，则数据应当跨越 y 轴</p></li><li><p>snp 数量较少时效果比较大，snp 数量多时效果不大，但是为了研究的完整性，还是要做</p></li><li><p>使用函数<code>mr_leaveoneout_plot()</code>和<code>mr_leaveoneout()</code>，数据为协同化的数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mr_leaveoneout_plot(</span><br><span class="line">  leaveoneout_results =</span><br><span class="line">    mr_leaveoneout(dat_harmon)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chide-org/PicGo/main/img/mr_leaveoneout_plot.png" alt="mr_leaveoneout_plot"></p></li></ul><h2 id="补充：在线数据分析"><a href="#补充：在线数据分析" class="headerlink" title="补充：在线数据分析"></a>补充：在线数据分析</h2><ul><li><p>在线提取数据，优点是方便，缺点是数据不够新</p></li><li><p>下面代码操作之后可以直接进入 harmonization 协同化</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">exposure &lt;- extract_instruments(</span><br><span class="line">  outcomes = &quot;ieu-b-40&quot;</span><br><span class="line">  )</span><br><span class="line">View(exposure)</span><br><span class="line"></span><br><span class="line">outcome &lt;-extract_outcome_data(</span><br><span class="line">  snps = exposure$SNP,</span><br><span class="line">  outcome = &quot;ieu-b-2&quot;</span><br><span class="line">  )</span><br><span class="line">View(outcome)</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> 生信 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 孟德尔随机化 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
